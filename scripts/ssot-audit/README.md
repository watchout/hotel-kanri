# SSOT監査システム（ハイブリッド構成）

## 📋 概要

Cursorで作成したSSOTをGPT-4o-miniで自動監査するシステム。

**月額コスト**: 約$1（月20タスク想定）

## 🔄 ワークフロー

```
┌─────────────────────────────────────┐
│ 1. SSOT作成（Cursor）               │
│    → 人間が確認しながら作成         │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│ 2. SSOT監査（自動）                 │
│    → GPT-4o-mini × 2で二重チェック  │
│    → コスト: $0.04/回               │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│ 3. 指摘確認（Cursor）               │
│    → レポートを確認                 │
│    → Critical指摘を修正             │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│ 4. 再監査（必要に応じて）           │
│    → スコア80点以上でOK             │
└─────────────────────────────────────┘
              ↓
┌─────────────────────────────────────┐
│ 5. プロンプト生成（Cursor）         │
│    → >> prmt コマンドで生成         │
└─────────────────────────────────────┘
```

## 🚀 使い方

### 基本コマンド

```bash
# SSOTファイルを監査
node scripts/ssot-audit/audit-ssot.cjs docs/03_ssot/00_foundation/SSOT_XXX.md
```

### 出力

- **JSON結果**: `evidence/ssot-audit/SSOT_XXX-{timestamp}.json`
- **レポート**: `evidence/ssot-audit/SSOT_XXX-AUDIT-REPORT.md`

### レポート例

```markdown
# SSOT監査レポート: SSOT_PERMISSION_SYSTEM

**総合スコア**: 82/100

## 指摘事項

### 🔴 Critical（1件）
1. [T02] カラム名命名規則違反
   → @map("created_at")を追加

### 🟡 Warning（2件）
1. [I03] Accept条件不足
2. [I09] テストケース未定義
```

## 📊 評価基準

### 技術的正確性（50点）

| ID | 項目 | 配点 |
|:---|:-----|:-----|
| T01-T05 | DB設計 | 各3点 |
| T06-T10 | API設計 | 各3点 |
| T11-T15 | 認証 | 各4点 |

### 実装可能性（50点）

| ID | 項目 | 配点 |
|:---|:-----|:-----|
| I01-I05 | 要件定義 | 各4点 |
| I06-I09 | チェックリスト | 各3点 |
| I10-I15 | その他 | 各3点 |

## 🎯 合格基準

| スコア | 判定 | アクション |
|:-------|:-----|:-----------|
| 90+ | ✅ 優秀 | そのまま進行 |
| 80-89 | ✅ 良好 | 軽微な修正推奨 |
| 60-79 | 🟡 要改善 | Warning対応推奨 |
| 0-59 | 🔴 要修正 | Critical対応必須 |

## 💰 コスト

| 項目 | コスト |
|:-----|:-------|
| 1回の監査 | $0.04 |
| 月20タスク | $0.80 |
| 年間 | $9.60 |

## 🔧 設定

### 環境変数

`.env.mcp`に以下を設定：

```
OPENAI_API_KEY=sk-...
```

### カスタマイズ

`audit-ssot.cjs`の`CHECKLIST`を編集して評価項目を変更可能。

## 📚 関連ドキュメント

- [SSOT品質チェックリスト](../../docs/03_ssot/00_foundation/SSOT_QUALITY_CHECKLIST.md)
- [SSOT作成ルール](../../docs/03_ssot/SSOT_CREATION_RULES.md)
