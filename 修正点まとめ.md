# ローカル→開発環境デプロイのための修正点

## 1. 修正したファイル

現在、ローカル環境から開発環境へのデプロイが失敗している原因を特定し、以下のファイルを修正しました。修正したファイルはすべて `modified/` ディレクトリに保存してあります。

### 1.1. Vue/CSSファイルの末尾の「%」記号を削除

以下のファイルの末尾に余分な「%」記号があり、ビルド時に `import.meta` エラーを引き起こしていました。

- `layouts/fullscreen.vue`
- `layouts/receipt.vue`
- `layouts/operation.vue`
- `layouts/info.vue`
- `assets/css/billing-fix.css`

### 1.2. prisma.tsのエクスポート方法を修正

`server/utils/prisma.ts` ファイルでは `export default prisma` のみで、`export { prisma }` がなかったため、
`server/api/v1/concierge/chat.post.ts` などで `import { prisma } from '@/server/utils/prisma'` としている箇所でエラーが発生していました。

### 1.3. nuxt.config.tsの修正

`nuxt.config.ts` ファイルから問題のある `billing-fix.css` のインポートを削除しました。

### 1.4. package.jsonの依存関係の修正

`package.json` ファイルの依存関係に競合があり、特に以下の点を修正しました：

- `react` のバージョンを `^19.1.1` から `^18.2.0` に変更（`next-auth` との互換性のため）
- `lru-cache` のバージョンを `^11.1.0` から `^10.2.0` に変更（Node.js v18との互換性のため）
- `vue-i18n` パッケージを追加（`components/tag/TagList.vue` で使用されているため）

## 2. デプロイ手順

これらの修正をローカルリポジトリに適用し、GitHubにプッシュした後、GitHub Actionsを通じて開発環境にデプロイする必要があります。

1. ローカルリポジトリで修正を適用
2. 修正をコミット
3. GitHubにプッシュ
4. GitHub Actionsワークフローを実行

## 3. 注意点

- 開発サーバーのNode.jsバージョンをv20以上にアップグレードすることも検討すべきです（`@sidebase/nuxt-auth` や `lru-cache` などのパッケージがNode.js v20以上を要求しているため）
- 直接サーバー上でファイルを編集するのではなく、常にローカル→Git→CI/CDのフローを使用することが重要です
