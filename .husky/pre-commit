#!/bin/sh
# QOS v1 pre-commit: spectral & semgrep
if command -v npx >/dev/null 2>&1; then
  npx @stoplight/spectral-cli lint docs/03_ssot/openapi/staff-management.yaml || exit 1
  [ -f docs/03_ssot/openapi/generic-resources.yaml ] && npx @stoplight/spectral-cli lint docs/03_ssot/openapi/generic-resources.yaml || true
fi
if command -v semgrep >/dev/null 2>&1; then
  semgrep --config .semgrep.yml || exit 1
else
  echo "⚠ semgrep not found; skipping"
fi

# SSOT リンク整合性チェック (DEV-0179)
if command -v node >/dev/null 2>&1; then
  node scripts/quality/check-ssot-links.cjs || exit 1
fi
