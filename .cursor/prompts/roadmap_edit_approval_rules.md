# ロードマップ編集承認ルール

**作成日**: 2025-10-15  
**優先度**: 🔴 最高（絶対遵守）  
**適用対象**: 全AI（Sun/Luna/Suno/Iza）

---

## 🚨 絶対ルール

### ロードマップ編集は必ず事前承認が必要

**対象ファイル**:
- `/Users/kaneko/hotel-kanri/docs/03_ssot/SSOT_PROGRESS_MASTER.md`

**絶対禁止**:
- ❌ ユーザーの承認なしにロードマップを編集する
- ❌ 「必要だから」と判断して勝手に修正する
- ❌ タスクを追加・削除・変更する
- ❌ 優先度・順序を変更する
- ❌ Phase構成を変更する

---

## ✅ 正しいプロセス

### Step 1: 編集の必要性を検出

**検出するケース**:
- 依存関係の問題を発見
- タスクの追加が必要
- タスクの削除が必要
- 順序の変更が必要
- Phase構成の変更が必要

### Step 2: ユーザーに提案

**必須項目**:
```markdown
## 🚨 ロードマップ編集の提案

### 編集理由
[なぜ編集が必要か]

### 編集内容
- 追加: [追加するタスク]
- 削除: [削除するタスク]
- 変更: [変更する内容]

### 影響範囲
- Phase X: [影響内容]
- 全体タスク数: XX件 → YY件
- 進捗率: XX% → YY%

### 判断
このロードマップ編集を承認しますか？
- [ ] 承認する
- [ ] 修正して再提案
- [ ] 却下
```

### Step 3: 承認待ち

**絶対ルール**:
- ✅ ユーザーの明示的な承認を待つ
- ❌ 承認前に編集を開始しない
- ❌ 「たぶんOK」で進めない

### Step 4: 承認後のみ編集

**実施内容**:
1. ロードマップを編集
2. バージョン番号を更新
3. 更新履歴を記録
4. 完了報告

---

## 🎯 編集時の必須チェック

### 編集前の確認

- [ ] ユーザーから明示的な承認を得た
- [ ] 編集内容をユーザーに説明した
- [ ] 影響範囲を明示した
- [ ] 代替案を検討した

### 編集中の確認

- [ ] 承認された内容のみを編集
- [ ] 追加の変更は行わない
- [ ] 一貫性を保つ

### 編集後の確認

- [ ] バージョン番号を更新
- [ ] 更新履歴を記録
- [ ] 全体の整合性を確認
- [ ] ユーザーに完了報告

---

## 📋 承認が必要な編集の例

### ✅ 承認が必要

1. **タスクの追加**
   - 例: SSOT_ADMIN_CAMPAIGNSの追加
   - 理由: ロードマップの範囲変更

2. **タスクの削除**
   - 例: 不要になったタスクの削除
   - 理由: ロードマップの範囲変更

3. **タスクの順序変更**
   - 例: 依存関係による順序変更
   - 理由: 実装順序の変更

4. **Phase構成の変更**
   - 例: Week数の変更、Phase分割
   - 理由: プロジェクト構造の変更

5. **優先度の変更**
   - 例: 🔴 → 🟡 への変更
   - 理由: 優先度判断の変更

6. **工数の変更**
   - 例: 2日 → 3日への変更
   - 理由: 見積もりの変更

### ❌ 承認不要（通常の更新）

1. **進捗状況の更新**
   - タスク完了マーク（❌ → ✅）
   - 進捗率の更新

2. **誤字脱字の修正**
   - タイポの修正
   - フォーマットの修正

3. **SSOTバージョンの更新**
   - 実装完了後のバージョン記録

---

## 🚫 違反時の対応

### 承認なしに編集した場合

1. **即座に報告**
   ```
   🚨 ロードマップを承認なしに編集してしまいました
   
   編集内容: [内容]
   理由: [理由]
   
   申し訳ございません。
   元に戻しますか？それとも追認しますか？
   ```

2. **変更のロールバック準備**
   - 編集前の状態を記録
   - ロールバック手順を提示

3. **再発防止**
   - このルールを再確認
   - プロセスを見直し

---

## 📝 承認記録テンプレート

### ロードマップ編集承認記録

```markdown
## ロードマップ編集承認

**日付**: YYYY-MM-DD
**バージョン**: vX.X.X → vY.Y.Y
**提案者**: [AI名]
**承認者**: ユーザー

### 編集内容
- 追加: [内容]
- 削除: [内容]
- 変更: [内容]

### 承認状況
- [x] ユーザー承認済み
- [x] 編集完了
- [x] 整合性確認済み
- [x] 完了報告済み

### 備考
[特記事項]
```

---

## 🎯 このルールの適用例

### 例1: 今回のケース（SSOT_ADMIN_CAMPAIGNS追加）

**✅ 正しい対応**:
1. 依存関係の問題を検出
2. ユーザーに提案（選択肢Aとして）
3. ユーザーから明示的承認を取得
   - 「この方針で。ロードマップの修正を許可します」
4. 承認後に編集を実施
5. バージョン更新（v4.1.0 → v4.2.0）
6. 完了報告

### 例2: もし承認なしに編集していたら（❌ 間違い）

**❌ 間違った対応**:
1. 依存関係の問題を検出
2. 「必要だから」と判断して勝手に編集
3. 編集後にユーザーに報告
4. → ルール違反

---

## 🔒 このルールの保護

### ルールファイルの配置

- **ファイル**: `/Users/kaneko/hotel-kanri/.cursor/prompts/roadmap_edit_approval_rules.md`
- **優先度**: 🔴 最高
- **参照タイミング**: ロードマップ編集を検討する都度

### .cursorrulesへの統合

このルールは`.cursorrules`にも記載し、全AIが常に参照できるようにする。

---

## ✅ AI自己チェックリスト

ロードマップ編集を検討する際、以下を自問する：

- [ ] **ユーザーの承認を得たか？**
- [ ] **編集内容を説明したか？**
- [ ] **影響範囲を明示したか？**
- [ ] **代替案を検討したか？**
- [ ] **承認前に編集を開始していないか？**

**1つでも「いいえ」がある場合**: 編集を停止し、ユーザーに相談

---

**最終更新**: 2025-10-15  
**バージョン**: 1.0.0  
**管理者**: 統合管理（全AI共通ルール）


