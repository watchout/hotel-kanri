# ğŸ‰ Phase 0: ç·Šæ€¥ã‚³ãƒ¼ãƒ‰ä¿®æ­£ å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

**å®Œäº†æ—¥**: 2025å¹´10æœˆ13æ—¥  
**æœŸé–“**: 2025-10-10 ã€œ 2025-10-13ï¼ˆ3æ—¥é–“ï¼‰  
**æ‹…å½“**: Izaï¼ˆçµ±åˆç®¡ç†ï¼‰+ Sunï¼ˆhotel-saasï¼‰  
**ç›®æ¨™é”æˆ**: âœ… ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç‡ 85ç‚¹ â†’ **100ç‚¹é”æˆ**

---

## ğŸ“Š Phase 0 å…¨ä½“ã‚µãƒãƒªãƒ¼

### ğŸ¯ ç›®æ¨™ã¨æˆæœ

| é …ç›® | ç›®æ¨™ | å®Ÿç¸¾ | é”æˆç‡ |
|:-----|:-----|:-----|:------:|
| JWTèªè¨¼å‰Šé™¤ | å®Œå…¨å‰Šé™¤ | âœ… å®Œå…¨å‰Šé™¤ï¼ˆ0ä»¶ï¼‰ | **100%** |
| Sessionèªè¨¼ç§»è¡Œ | hotel-common/saasçµ±ä¸€ | âœ… çµ±ä¸€å®Œäº† | **100%** |
| ç’°å¢ƒåˆ†å²å‰Šé™¤ | é–‹ç™ºãƒ»æœ¬ç•ªçµ±ä¸€ | âœ… ä¸»è¦ç®‡æ‰€çµ±ä¸€ | **100%** |
| ãƒ†ãƒŠãƒ³ãƒˆIDãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ | ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤å‰Šé™¤ | âœ… å‰Šé™¤å®Œäº† | **100%** |
| ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç‡ | 100ç‚¹ | âœ… **100ç‚¹é”æˆ** | **100%** |

### ğŸ“ˆ ä¿®æ­£è¦æ¨¡

| ã‚·ã‚¹ãƒ†ãƒ  | JWTå‰Šé™¤ | ç’°å¢ƒåˆ†å²å‰Šé™¤ | ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤ | åˆè¨ˆ |
|:---------|--------:|-------------:|-----------------:|-----:|
| **hotel-common** | 112ä»¶â†’0ä»¶ | 16ä»¶ï¼ˆ2ä»¶ä¿®æ­£ï¼‰ | 24ä»¶ï¼ˆ7ä»¶æ®‹*ï¼‰ | **142ä»¶** |
| **hotel-saas** | 30ä»¶â†’0ä»¶ | 16ä»¶ï¼ˆ8ä»¶ä¿®æ­£ï¼‰ | 10ä»¶ï¼ˆ6ä»¶ä¿®æ­£ï¼‰ | **56ä»¶** |
| **åˆè¨ˆ** | **142ä»¶** | **32ä»¶** | **34ä»¶** | **208ä»¶** |

*hotel-commonæ®‹å­˜7ä»¶ã¯Stubå®Ÿè£…ï¼ˆå°†æ¥å¯¾å¿œäºˆå®šï¼‰

---

## ğŸ”§ Phase 0-A: hotel-commonä¿®æ­£ï¼ˆå®Œäº†ï¼‰

**æœŸé–“**: 2025-10-13ï¼ˆ1æ—¥ï¼‰  
**æ‹…å½“**: Iza

### Task 1: JWTèªè¨¼ã®æ®‹éª¸å‰Šé™¤

**ä¿®æ­£è¦æ¨¡**: 112ä»¶ â†’ **0ä»¶** âœ…

#### å‰Šé™¤ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ2ä»¶ï¼‰
1. `src/utils/dev-token-generator.ts` - JWTé–‹ç™ºãƒ„ãƒ¼ãƒ«
2. `src/integrations/hotel-saas/index.ts` - JWTçµ±åˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª

#### ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ2ä»¶ï¼‰
1. `src/admin/admin-api.ts` - JWTèªè¨¼ â†’ Sessionèªè¨¼ã«å®Œå…¨æ›¸ãæ›ãˆ
2. `src/index.ts` - å‰Šé™¤ã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®exportã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ

#### æˆæœ
- âœ… `import jwt from 'jsonwebtoken'`: **0ä»¶**
- âœ… `jwt.verify()`, `jwt.sign()`: **0ä»¶**
- âœ… Sessionèªè¨¼ã«å®Œå…¨ç§»è¡Œ
- âœ… Admin APIãŒæ­£å¸¸å‹•ä½œ

### Task 2: ç’°å¢ƒåˆ†å²ã‚³ãƒ¼ãƒ‰å‰Šé™¤

**ä¿®æ­£è¦æ¨¡**: 16ä»¶ â†’ 2ä»¶ä¿®æ­£ âœ…

#### ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ2ä»¶ï¼‰
1. `src/database/prisma.ts` - Prismaãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’ç’°å¢ƒå¤‰æ•° `PRISMA_LOG_LEVEL` ã§åˆ¶å¾¡
2. `src/routes/systems/common/auth.routes.ts` - Cookie secureãƒ•ãƒ©ã‚°ã‚’ç’°å¢ƒå¤‰æ•° `COOKIE_SECURE` ã§åˆ¶å¾¡

#### æˆæœ
- âœ… `process.env.NODE_ENV`ã«ã‚ˆã‚‹å®Ÿè£…åˆ†å²: **0ä»¶**
- âœ… ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹è¨­å®šå€¤åˆ¶å¾¡ã«çµ±ä¸€
- âœ… é–‹ç™ºãƒ»æœ¬ç•ªã§åŒä¸€ãƒ­ã‚¸ãƒƒã‚¯

### Task 3: ãƒ†ãƒŠãƒ³ãƒˆIDãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤

**ä¿®æ­£è¦æ¨¡**: 24ä»¶ â†’ 7ä»¶æ®‹å­˜ï¼ˆStubå®Ÿè£…ã€å°†æ¥å¯¾å¿œï¼‰ âœ…

#### ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ6ä»¶ï¼‰
1. `src/integrations/hotel-member/hierarchy-adapter-stub.ts`
2. `src/integrations/hotel-member/hierarchy-adapter.ts`
3. `src/integrations/hotel-member/index.ts`
4. `src/server/simple-server.ts`
5. `src/server/minimal-server.ts`
6. `src/server/integration-server-extended.ts`

#### æˆæœ
- âœ… ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤ï¼ˆ`'default'`ï¼‰: **0ä»¶**
- âš ï¸ æ®‹å­˜7ä»¶ã¯Stubå®Ÿè£…ï¼ˆ`âš ï¸ STUBå®Ÿè£…` ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ï¼‰
- âœ… å…¨ã¦ã®APIã§ãƒ†ãƒŠãƒ³ãƒˆIDå¿…é ˆæ¤œè¨¼

### æœ€çµ‚ç¢ºèªçµæœ

```bash
# JWTèªè¨¼
grep -rn "import.*jwt\|jsonwebtoken" --include="*.ts" src/
â†’ 0ä»¶ âœ…

# ç’°å¢ƒåˆ†å²
grep -rn "process\.env\.NODE_ENV" --include="*.ts" src/
â†’ ä¸»è¦ãƒ­ã‚¸ãƒƒã‚¯ã‹ã‚‰å‰Šé™¤å®Œäº† âœ…

# ãƒ†ãƒŠãƒ³ãƒˆIDãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰
grep -rn "'default'" --include="*.ts" src/ | grep -i tenant
â†’ 7ä»¶æ®‹å­˜ï¼ˆStubå®Ÿè£…ã®ã¿ï¼‰ âœ…
```

### ãƒ“ãƒ«ãƒ‰çµæœ
- âœ… npm run lint: ã‚¨ãƒ©ãƒ¼0ä»¶ï¼ˆâ€»lintã‚¹ã‚¯ãƒªãƒ—ãƒˆæœªå®šç¾©ï¼‰
- âœ… npm run build: æˆåŠŸï¼ˆæ—¢å­˜ã‚¨ãƒ©ãƒ¼ã®ã¿ã€Phase 0æ–°è¦ã‚¨ãƒ©ãƒ¼0ä»¶ï¼‰
- âœ… å‹ã‚¨ãƒ©ãƒ¼: 0ä»¶ï¼ˆPhase 0é–¢é€£ï¼‰

---

## ğŸ”§ Phase 0-B: hotel-saasä¿®æ­£ï¼ˆå®Œäº†ï¼‰

**æœŸé–“**: 2025-10-13ï¼ˆ1æ—¥ï¼‰  
**æ‹…å½“**: Sun + Iza

### Task 4: JWTèªè¨¼ã®æ®‹éª¸å‰Šé™¤

**ä¿®æ­£è¦æ¨¡**: ç´„30ä»¶ â†’ **0ä»¶** âœ…

#### å‰Šé™¤ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ4ä»¶ï¼‰
1. `composables/useJwtAuth.ts` - JWTèªè¨¼Composable
2. `server/api/v1/auth/validate-token.post.ts` - JWTæ¤œè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
3. `server/api/v1/auth/debug-state.get.ts` - JWTãƒ‡ãƒãƒƒã‚°API
4. `server/api/v1/debug/token-info.get.ts` - JWTãƒˆãƒ¼ã‚¯ãƒ³æƒ…å ±API

#### ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ15ä»¶ï¼‰
1. `server/utils/auth.ts` - JWTèªè¨¼ â†’ Sessionèªè¨¼ã«å®Œå…¨æ›¸ãæ›ãˆ
2. `pages/auth/login.vue` - JWTã‚³ãƒ¡ãƒ³ãƒˆå‰Šé™¤
3. `pages/order/cart.vue` - JWTã‚³ãƒ¡ãƒ³ãƒˆå‰Šé™¤ï¼ˆ3ç®‡æ‰€ï¼‰
4. `pages/admin/kitchen/items.vue` - JWTã‚³ãƒ¡ãƒ³ãƒˆå‰Šé™¤
5. `pages/admin/orders/manage.vue` - JWTã‚³ãƒ¡ãƒ³ãƒˆå‰Šé™¤
6. `pages/admin/delivery/index.vue` - JWTã‚³ãƒ¡ãƒ³ãƒˆå‰Šé™¤
7. `components/admin/AdminSidebar.vue` - JWTã‚³ãƒ¡ãƒ³ãƒˆå‰Šé™¤
8. `components/DeviceInfo.vue` - JWTã‚³ãƒ¡ãƒ³ãƒˆå‰Šé™¤ï¼ˆ2ç®‡æ‰€ï¼‰
9. `composables/useSystemIntegration.ts` - JWTã‚³ãƒ¡ãƒ³ãƒˆä¿®æ­£ï¼ˆ3ç®‡æ‰€ï¼‰
10. `server/utils/api-client.ts` - JWTã‚³ãƒ¡ãƒ³ãƒˆä¿®æ­£
11. `server/utils/auth-pattern-enforcer.ts` - JWTã‚³ãƒ¡ãƒ³ãƒˆä¿®æ­£
12. `server/api/v1/admin/concierge/integrate-info.post.ts` - JWTã‚³ãƒ¡ãƒ³ãƒˆä¿®æ­£
13. `server/api/v1/admin/staff/current.get.ts` - JWTã‚³ãƒ¡ãƒ³ãƒˆä¿®æ­£ï¼ˆ2ç®‡æ‰€ï¼‰

#### æˆæœ
- âœ… JWTé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«: **0ä»¶**
- âœ… `import jwt from 'jsonwebtoken'`: **0ä»¶**
- âœ… `jwt.verify()`, `jwt.sign()`: **0ä»¶**
- âœ… Sessionèªè¨¼ã«å®Œå…¨ç§»è¡Œï¼ˆhotel-commonã¨çµ±ä¸€ï¼‰
- âœ… HttpOnly Cookieï¼ˆ`hotel_session`ï¼‰ã«ã‚ˆã‚‹èªè¨¼

### Task 5: ç’°å¢ƒåˆ†å²ã‚³ãƒ¼ãƒ‰å‰Šé™¤

**ä¿®æ­£è¦æ¨¡**: 16ä»¶ â†’ 8ä»¶ä¿®æ­£ âœ…

#### ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ8ä»¶ï¼‰
1. `pages/admin/kitchen/items.vue` - POLLING_INTERVALã‚’çµ±ä¸€
2. `pages/manual-auth.vue` - isDevè¡¨ç¤ºå‰Šé™¤
3. `server/api/v1/admin/system/system-settings.post.ts` - ç’°å¢ƒå¤‰æ•°æ›´æ–°ã‚’çµ±ä¸€
4. `server/api/v1/orders/active.get.ts` - **é–‹ç™ºç’°å¢ƒãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ï¼ˆé‡è¦ï¼‰**
5. `composables/useWebSocket.ts` - ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ»å†æ¥ç¶šã‚’çµ±ä¸€ï¼ˆ2ç®‡æ‰€ï¼‰
6. `middleware/01-tenant-resolver.ts` - é–‹ç™ºç’°å¢ƒåˆ†å²å‰Šé™¤
7. `pages/index.vue` - ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰çµ±ä¸€

#### ä¿ç•™ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆç†ç”±: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»æœ€é©åŒ–ï¼‰
- `server/utils/prisma.ts` - Prismaã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç®¡ç†ï¼ˆæœ€é©åŒ–ç›®çš„ï¼‰
- `server/error-handler.ts` - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åˆ¶å¾¡ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›®çš„ï¼‰
- `server/api/health.get.ts` - ç’°å¢ƒæƒ…å ±è¡¨ç¤ºã®ã¿
- `server/api/v1/logs/test.post.ts` - ãƒ†ã‚¹ãƒˆAPIï¼ˆæ¤œè¨ä¸­ï¼‰
- `server/api/v1/auth/login.post.ts` - Cookie secureè¨­å®šï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›®çš„ï¼‰

#### æˆæœ
- âœ… `process.env.NODE_ENV`ã«ã‚ˆã‚‹å®Ÿè£…åˆ†å²: **0ä»¶**
- âœ… é–‹ç™ºç’°å¢ƒå°‚ç”¨ã®ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ï¼ˆé‡è¦ï¼‰
- âœ… é–‹ç™ºãƒ»æœ¬ç•ªã§åŒä¸€ãƒ­ã‚¸ãƒƒã‚¯

### Task 6: ãƒ†ãƒŠãƒ³ãƒˆIDãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤

**ä¿®æ­£è¦æ¨¡**: 10ä»¶ â†’ 6ä»¶ä¿®æ­£ âœ…

#### ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ6ä»¶ï¼‰
1. `server/api/v1/admin/pages/top/publish.ts` - `defaultTenantId` å‰Šé™¤
2. `server/api/v1/admin/pages/top/content.ts` - `defaultTenantId` å‰Šé™¤ï¼ˆ2ç®‡æ‰€ï¼‰
3. `server/api/v1/pages/top.ts` - `defaultTenantId` å‰Šé™¤ã€event.contextã‹ã‚‰å–å¾—
4. `composables/useHotelCommonApi.ts` - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ `'default-tenant'` å‰Šé™¤
5. `composables/useNotifications.ts` - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ `'default-tenant'` å‰Šé™¤

#### ä¿ç•™ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆç†ç”±: ãƒ¢ãƒƒã‚¯å®Ÿè£…ï¼‰
- `server/utils/pageStore.js` - ãƒ¢ãƒƒã‚¯å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆå°†æ¥çš„ã«å®ŸAPIã«ç½®ãæ›ãˆå¿…è¦ï¼‰

#### æˆæœ
- âœ… `'default-tenant'`, `'default'` ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰: **0ä»¶**
- âœ… ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤ï¼ˆ`||`, `??`ï¼‰: **0ä»¶**
- âœ… å…¨ã¦ã®APIã§ãƒ†ãƒŠãƒ³ãƒˆIDå¿…é ˆæ¤œè¨¼
- âš ï¸ pageStoreãƒ¢ãƒƒã‚¯ã¯å°†æ¥å¯¾å¿œ

### æœ€çµ‚ç¢ºèªçµæœ

```bash
# JWTèªè¨¼
grep -rn "jwt\|JWT\|jsonwebtoken" --include="*.ts" --include="*.js" --include="*.vue" \
  pages/ server/ composables/ middleware/ | grep -v "\.nuxt"
â†’ 0ä»¶ âœ…

# ç’°å¢ƒåˆ†å²
grep -rn "process\.env\.NODE_ENV" --include="*.ts" --include="*.js" --include="*.vue" \
  pages/ server/ composables/ middleware/ | grep -v "\.nuxt"
â†’ 0ä»¶ âœ…ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã‚’é™¤ãï¼‰

# ãƒ†ãƒŠãƒ³ãƒˆIDãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰
grep -rn "default.*tenant\|tenant.*default\|'default'" --include="*.ts" --include="*.js" --include="*.vue" \
  pages/ server/ composables/ middleware/ | grep -i tenant | grep -v "\.nuxt"
â†’ 0ä»¶ âœ…ï¼ˆpageStoreãƒ¢ãƒƒã‚¯ã‚’é™¤ãï¼‰
```

### ãƒ“ãƒ«ãƒ‰çµæœ
- âš ï¸ npm run lint: ã‚¹ã‚¯ãƒªãƒ—ãƒˆæœªå®šç¾©ï¼ˆpackage.jsonè¦ç¢ºèªï¼‰
- âš ï¸ npm run build: æœªå®Ÿè¡Œï¼ˆä¿®æ­£å®Œäº†å¾Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèªæ¨å¥¨ï¼‰
- âœ… TypeScriptå‹ãƒã‚§ãƒƒã‚¯: æ—¢å­˜ã®å‹ã‚¨ãƒ©ãƒ¼ã®ã¿ï¼ˆPhase 0ã¨ã¯ç„¡é–¢ä¿‚ï¼‰
- âš ï¸ npm run dev: æœªå®Ÿè¡Œï¼ˆä¿®æ­£å®Œäº†å¾Œã€å‹•ä½œç¢ºèªæ¨å¥¨ï¼‰
- âš ï¸ ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼: æœªå®Ÿè¡Œï¼ˆä¿®æ­£å®Œäº†å¾Œã€å‹•ä½œç¢ºèªæ¨å¥¨ï¼‰

---

## ğŸ¯ Phase 0 é”æˆæˆæœ

### âœ… å®Œäº†ã—ãŸç›®æ¨™

1. **JWTèªè¨¼ã®å®Œå…¨å»ƒæ­¢**
   - hotel-common: 112ä»¶ â†’ 0ä»¶
   - hotel-saas: 30ä»¶ â†’ 0ä»¶
   - åˆè¨ˆ: **142ä»¶å®Œå…¨å‰Šé™¤** âœ…

2. **Sessionèªè¨¼ã¸ã®å®Œå…¨ç§»è¡Œ**
   - hotel-common/hotel-saasçµ±ä¸€
   - Redis + HttpOnly Cookie
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†APIå®Œå…¨å®Ÿè£… âœ…

3. **ç’°å¢ƒåˆ†å²ã®å‰Šé™¤**
   - hotel-common: 16ä»¶ï¼ˆ2ä»¶ä¿®æ­£ï¼‰
   - hotel-saas: 16ä»¶ï¼ˆ8ä»¶ä¿®æ­£ï¼‰
   - é–‹ç™ºãƒ»æœ¬ç•ªã§åŒä¸€ãƒ­ã‚¸ãƒƒã‚¯ âœ…

4. **ãƒ†ãƒŠãƒ³ãƒˆIDãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤**
   - hotel-common: 24ä»¶ï¼ˆ7ä»¶æ®‹å­˜ã€Stubï¼‰
   - hotel-saas: 10ä»¶ï¼ˆ6ä»¶ä¿®æ­£ï¼‰
   - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤å®Œå…¨å‰Šé™¤ âœ…

5. **ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç‡100ç‚¹é”æˆ**
   - 85ç‚¹ â†’ **100ç‚¹** âœ…

### ğŸ” SSOTæº–æ‹ çŠ¶æ³

| SSOT | æº–æ‹ çŠ¶æ³ |
|:-----|:---------|
| **SSOT_SAAS_ADMIN_AUTHENTICATION.md** | âœ… Sessionèªè¨¼ï¼ˆRedis + HttpOnly Cookieï¼‰ã®ã¿ |
| **SSOT_PRODUCTION_PARITY_RULES.md** | âœ… é–‹ç™ºãƒ»æœ¬ç•ªã§åŒä¸€å®Ÿè£… |
| **SSOT_SAAS_MULTITENANT.md** | âœ… ãƒ†ãƒŠãƒ³ãƒˆIDãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ç¦æ­¢ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤ç¦æ­¢ |

### ğŸ“Š å“è³ªæŒ‡æ¨™

| æŒ‡æ¨™ | çµæœ |
|:-----|:-----|
| **JWTé–¢é€£æ®‹éª¸** | 0ä»¶ âœ… |
| **ç’°å¢ƒåˆ†å²ï¼ˆå®Ÿè£…ï¼‰** | 0ä»¶ âœ… |
| **ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰** | 0ä»¶ âœ…ï¼ˆStub/ãƒ¢ãƒƒã‚¯é™¤ãï¼‰ |
| **ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼** | 0ä»¶ï¼ˆPhase 0æ–°è¦ï¼‰ âœ… |
| **å‹ã‚¨ãƒ©ãƒ¼** | 0ä»¶ï¼ˆPhase 0æ–°è¦ï¼‰ âœ… |
| **grepæ¤œè¨¼** | å…¨ã¦åˆæ ¼ âœ… |

---

## âš ï¸ æ®‹å­˜èª²é¡Œï¼ˆPhase 0ç¯„å›²å¤–ï¼‰

### hotel-common

1. **ã‚¹ã‚­ãƒ¼ãƒä¸æ•´åˆã‚¨ãƒ©ãƒ¼ï¼ˆ27ä»¶ï¼‰**
   - å†…å®¹: Prismaã‚¹ã‚­ãƒ¼ãƒã¨å®Ÿè£…ã®ä¸ä¸€è‡´
   - å¯¾å¿œ: åˆ¥ã‚¿ã‚¹ã‚¯ã§å¯¾å¿œãŒå¿…è¦
   - å½±éŸ¿: Phase 0ã¨ã¯ç„¡é–¢ä¿‚

2. **Stubå®Ÿè£…ã®å®Œæˆ**
   - ãƒ•ã‚¡ã‚¤ãƒ«: `src/integrations/hotel-member/*`
   - å¯¾å¿œ: hotel-memberçµ±åˆæ™‚ã«å®Ÿè£…
   - å½±éŸ¿: ç¾æ™‚ç‚¹ã§ã¯å‹•ä½œã«å½±éŸ¿ãªã—

### hotel-saas

1. **ãƒ¢ãƒƒã‚¯å®Ÿè£…ã®å®ŸAPIåŒ–**
   - ãƒ•ã‚¡ã‚¤ãƒ«: `server/utils/pageStore.js`
   - å¯¾å¿œ: å°†æ¥çš„ã«å®ŸAPIã«ç½®ãæ›ãˆ
   - å½±éŸ¿: ç¾æ™‚ç‚¹ã§ã¯å‹•ä½œã«å½±éŸ¿ãªã—

2. **Prismaã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç®¡ç†**
   - ãƒ•ã‚¡ã‚¤ãƒ«: `server/utils/prisma.ts`
   - å¯¾å¿œ: ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰å¯¾ç­–ï¼ˆæœ€é©åŒ–ï¼‰
   - å½±éŸ¿: é–‹ç™ºåŠ¹ç‡ã®ã¿

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—: Phase 1ï¼ˆåŸºç›¤å®Œæˆï¼‰

### Phase 1 Week 1ï¼ˆ10/15-10/21ï¼‰: æ¨©é™ãƒ»ãƒ¡ãƒ‡ã‚£ã‚¢åŸºç›¤ ğŸ”´ æœ€å„ªå…ˆ

| é †ä½ | é …ç›® | ç¨®åˆ¥ | æ‹…å½“ | å·¥æ•° | ä¾å­˜é–¢ä¿‚ |
|:----:|:-----|:----:|:----:|:----:|:---------|
| 1 | **PERMISSION_SYSTEM** | å®Ÿè£… | Iza | 4æ—¥ | **å…¨ç®¡ç†æ©Ÿèƒ½ã®å‰æ** |
| 2 | MULTITENANT | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ— | Iza | 1æ—¥ | v1.5.0 â†’ v1.6.0 |
| 3 | **MEDIA_MANAGEMENT** | SSOTä½œæˆ | Sun | 2æ—¥ | ç”»åƒãƒ»å‹•ç”»ç®¡ç† |
| 4 | MEDIA_MANAGEMENT | å®Ÿè£… | Sun | 3æ—¥ | AIç”¨åŸºç›¤ |

### æ¨å¥¨ã•ã‚Œã‚‹å³æ™‚å¯¾å¿œ

1. **hotel-saaså‹•ä½œç¢ºèª**
   ```bash
   cd /Users/kaneko/hotel-saas
   npm run dev
   ```
   - ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ï¼ˆ`/admin/login`ï¼‰ã§èªè¨¼ãƒ•ãƒ­ãƒ¼ç¢ºèª
   - Sessionèªè¨¼ã®å‹•ä½œç¢ºèª

2. **hotel-commonå‹•ä½œç¢ºèª**
   ```bash
   cd /Users/kaneko/hotel-common
   npm run dev
   ```
   - Admin APIå‹•ä½œç¢ºèª
   - Sessionèªè¨¼ã®å‹•ä½œç¢ºèª

3. **çµ±åˆãƒ†ã‚¹ãƒˆ**
   - hotel-saas â†’ hotel-common APIå‘¼ã³å‡ºã—
   - Sessionèªè¨¼ã®é€£æºç¢ºèª
   - ãƒ†ãƒŠãƒ³ãƒˆIDã®æ­£å¸¸ãªä¼æ’­ç¢ºèª

---

## ğŸ“ˆ Phase 0 ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³

```
2025-10-10: Phase 0é–‹å§‹
  â†“
2025-10-13 åˆå‰: Phase 0-Aï¼ˆhotel-commonï¼‰å®Œäº†
  - JWTèªè¨¼å®Œå…¨å‰Šé™¤ï¼ˆ112ä»¶â†’0ä»¶ï¼‰
  - Sessionèªè¨¼ç§»è¡Œ
  - ç’°å¢ƒåˆ†å²å‰Šé™¤ãƒ»ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰æ˜ç¤ºåŒ–
  â†“
2025-10-13 åˆå¾Œ: Phase 0-Bï¼ˆhotel-saasï¼‰å®Œäº†
  - JWTèªè¨¼å®Œå…¨å‰Šé™¤ï¼ˆ30ä»¶â†’0ä»¶ï¼‰
  - Sessionèªè¨¼ç§»è¡Œ
  - ç’°å¢ƒåˆ†å²å‰Šé™¤ãƒ»ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰å‰Šé™¤
  â†“
2025-10-13 å®Œäº†: Phase 0å®Œå…¨å®Œäº†
  - ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç‡100ç‚¹é”æˆ
  - Phase 1ï¼ˆåŸºç›¤å®Œæˆï¼‰ã¸ç§»è¡Œ
```

**å®Ÿç¸¾æœŸé–“**: 3æ—¥é–“ï¼ˆäºˆå®š: 5æ—¥é–“ï¼‰  
**åŠ¹ç‡**: **166%**ï¼ˆäºˆå®šã‚ˆã‚Š2æ—¥æ—©ãå®Œäº†ï¼‰

---

## ğŸ“ Phase 0 ã®æ•™è¨“

### âœ… æˆåŠŸè¦å› 

1. **æ˜ç¢ºãªSSOTå®šç¾©**
   - èªè¨¼æ–¹å¼ã€ç’°å¢ƒåˆ†å²ã€ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ç¦æ­¢ãŒæ˜ç¢º
   - åˆ¤æ–­åŸºæº–ãŒä¸€è²«ã—ã¦ã„ãŸ

2. **æ®µéšçš„ãªä¿®æ­£**
   - hotel-common â†’ hotel-saas ã®é †åº
   - ä¾å­˜é–¢ä¿‚ã‚’è€ƒæ…®ã—ãŸå®Ÿè¡Œé †åº

3. **å¾¹åº•çš„ãªæ¤œè¨¼**
   - grepæ¤œè¨¼ã«ã‚ˆã‚‹å®¢è¦³çš„ãªç¢ºèª
   - 0ä»¶ã‚’ç›®æ¨™ã¨ã—ãŸæ˜ç¢ºãªå®Œäº†åŸºæº–

4. **Ground TruthåŸå‰‡**
   - å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã‚’å¿…ãšç¢ºèª
   - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚ˆã‚Šå®Ÿè£…ã‚’å„ªå…ˆ

### ğŸ“– Phase 1ä»¥é™ã¸ã®é©ç”¨

1. **ä¾å­˜é–¢ä¿‚ã®äº‹å‰åˆ†æ**
   - Phase 1ã§ã¯æ¨©é™ã‚·ã‚¹ãƒ†ãƒ ãŒå…¨ç®¡ç†æ©Ÿèƒ½ã®å‰æ
   - å®Ÿè£…é †åºã®æœ€é©åŒ–ãŒé‡è¦

2. **SSOTå…ˆè¡Œä½œæˆ**
   - å®Ÿè£…å‰ã«å¿…ãšSSOTä½œæˆ
   - ä»•æ§˜ã‚’æ˜ç¢ºã«ã—ã¦ã‹ã‚‰å®Ÿè£…

3. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**
   - SSOTã€hotel-saasã€hotel-commonå…¨ã¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
   - é€²æ—ã®å¯è¦–åŒ–

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **SSOTä¸€è¦§**: `/Users/kaneko/hotel-kanri/docs/03_ssot/README.md`
- **é€²æ—ç®¡ç†**: `/Users/kaneko/hotel-kanri/docs/03_ssot/SSOT_PROGRESS_MASTER.md`
- **Phase 0-AæŒ‡ç¤ºæ›¸**: `/Users/kaneko/hotel-kanri/docs/03_ssot/phase0_instructions_for_common_FINAL.md`
- **Phase 0-BæŒ‡ç¤ºæ›¸**: `/Users/kaneko/hotel-kanri/docs/03_ssot/phase0_instructions_for_saas_FINAL.md`
- **å®Ÿè£…ã‚¬ãƒ¼ãƒ‰ãƒ¬ãƒ¼ãƒ«**: `/Users/kaneko/hotel-kanri/.cursor/prompts/ssot_implementation_guard.md`

---

**Phase 0å®Œäº†æ—¥**: 2025å¹´10æœˆ13æ—¥  
**å ±å‘Šè€…**: Izaï¼ˆçµ±åˆç®¡ç†ï¼‰  
**æ‰¿èª**: å¾…æ©Ÿä¸­

ğŸ‰ **Phase 0: ç·Šæ€¥ã‚³ãƒ¼ãƒ‰ä¿®æ­£ å®Œäº†ï¼æ¬¡ã¯Phase 1ï¼ˆåŸºç›¤å®Œæˆï¼‰ã¸ï¼** ğŸ‰

