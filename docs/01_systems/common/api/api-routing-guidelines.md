# Hotel-Common APIãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

## ğŸ“ **ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã«ãã„APIãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«**

ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ã€Nuxt/Nitroã§ã‚‚å®‰å®šå‹•ä½œã—ã€SaaSå´ã§ã®å‹•çš„ãƒ«ãƒ¼ãƒˆå‡¦ç†ã§ã‚‚ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚Šã«ãã„APIãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­è¨ˆåŸå‰‡ã‚’å®šã‚ã¦ã„ã¾ã™ã€‚

---

## ğŸ¯ **åŸºæœ¬åŸå‰‡**

### 1. **å‹•çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯æµ…ãã™ã‚‹**
- **åŸå‰‡**: å‹•çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯1éšå±¤ã¾ã§
- **ç†ç”±**: ãƒã‚¹ãƒˆãŒæ·±ã„ã¨ Nuxt/Nitro ã§èªè­˜ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã‚„ã™ã„

```typescript
// âœ… æ¨å¥¨
router.get('/rooms/:roomId', ...)
router.get('/reservations/:reservationId', ...)

// âŒ é¿ã‘ã‚‹
router.get('/rooms/:roomId/memos/:memoId/logs/:logId', ...)
```

**è¤‡é›‘ãªé–¢é€£ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ãªå ´åˆã¯ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨:**
```typescript
// âœ… æ¨å¥¨
router.get('/memos', ...) // ?roomId=101&logType=maintenance
```

### 2. **index.* ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¿ã‘ã‚‹**
- **åŸå‰‡**: `index.*` ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä½¿ç”¨ã—ãªã„
- **ç†ç”±**: Nuxt/Nitro ã®æ—¢çŸ¥ãƒã‚°ã§å‹•çš„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã® index ãŒèªè­˜ã•ã‚Œãªã„

```typescript
// âŒ é¿ã‘ã‚‹
server/api/rooms/[roomId]/memos/index.get.ts

// âœ… æ¨å¥¨
server/api/rooms/[roomId]/memos.get.ts
```

### 3. **ãƒªã‚½ãƒ¼ã‚¹åã‚’é™çš„ã«æ˜ç¤ºã™ã‚‹**
- **åŸå‰‡**: ä½•ã‚’ã‚­ãƒ¼ã«ã—ã¦ã„ã‚‹ã‹ã‚’ãƒ‘ã‚¹ã«å«ã‚ã‚‹
- **ç†ç”±**: å¾Œã‹ã‚‰è¦‹ã¦ã‚‚ã‚ã‹ã‚Šã‚„ã™ãã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¨ãƒ©ãƒ¼ã‚’é˜²ã

```typescript
// âœ… æ¨å¥¨
router.get('/rooms/by-number/:roomNumber', ...)
router.get('/rooms/by-id/:roomId', ...)
router.get('/reservations/by-guest/:guestId', ...)
```

### 4. **è¤‡é›‘ãªé–¢é€£ãƒªã‚½ãƒ¼ã‚¹ã¯ã€Œè¦ªIDï¼‹ã‚µãƒ–ãƒªã‚½ãƒ¼ã‚¹ã€ã§çµ±ä¸€**
- **åŸå‰‡**: é–¢é€£ãƒªã‚½ãƒ¼ã‚¹ã¯è¦ªãƒªã‚½ãƒ¼ã‚¹ã‚’æ˜ç¢ºã«ã™ã‚‹

```typescript
// âœ… æ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³
router.get('/rooms/:roomId/memos', ...)        // éƒ¨å±‹ã®ãƒ¡ãƒ¢ä¸€è¦§
router.post('/rooms/:roomId/memos', ...)       // éƒ¨å±‹ã«ãƒ¡ãƒ¢è¿½åŠ 
router.get('/rooms/:roomId/memos/:memoId', ...)// ç‰¹å®šãƒ¡ãƒ¢è©³ç´°
router.delete('/rooms/:roomId/memos/:memoId', ...)
```

### 5. **RESTåŸå‰‡ã«ã“ã ã‚ã‚Šã™ããªã„**
- **åŸå‰‡**: è¤‡é›‘ãªå‡¦ç†ã¯RPCçš„ã«å‰²ã‚Šåˆ‡ã‚‹
- **ç†ç”±**: ç„¡ç†ã«RESTfulã«ã™ã‚‹ã¨ä¸å®‰å®šã«ãªã‚‹

```typescript
// âœ… æ¨å¥¨
router.get('/memos/search', ...) // ?roomId=101&type=latest&status=pending
router.post('/billing/calculate', ...) // è¤‡é›‘ãªè¨ˆç®—å‡¦ç†
```

---

## ğŸ—ï¸ **Hotel-Common å›ºæœ‰ã®ãƒ«ãƒ¼ãƒ«**

### 6. **ãƒ‘ã‚¹æŒ‡å®šã®çµ±ä¸€**
- **åŸå‰‡**: ç›¸å¯¾ãƒ‘ã‚¹ã§çµ±ä¸€ï¼ˆãƒ•ãƒ«ãƒ‘ã‚¹æŒ‡å®šã¯é¿ã‘ã‚‹ï¼‰
- **ç†ç”±**: ãƒ«ãƒ¼ã‚¿ãƒ¼çµ±åˆæ™‚ã®æŸ”è»Ÿæ€§ã‚’ä¿ã¤

```typescript
// âœ… æ¨å¥¨
router.get('/:id', ...)
router.put('/:id', ...)
router.delete('/:id', ...)

// âŒ é¿ã‘ã‚‹
router.get('/api/v1/room-grades/:id', ...)
```

### 7. **ã‚µãƒ–ãƒªã‚½ãƒ¼ã‚¹ã®å‘½åè¦å‰‡**
- **åŸå‰‡**: è¤‡æ•°å½¢ + å‹•ä½œã‚’æ˜ç¤º

```typescript
// âœ… æ¨å¥¨
router.get('/:billingId/payments', ...)      // æ”¯æ‰•ã„ä¸€è¦§
router.post('/:billingId/payments', ...)     // æ”¯æ‰•ã„è¿½åŠ 
router.get('/:sessionId/calculations', ...)  // è¨ˆç®—çµæœå–å¾—
```

### 8. **ã‚·ã‚¹ãƒ†ãƒ åˆ¥ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ§‹é€ **
```
src/routes/systems/
â”œâ”€â”€ common/          # å…¨ã‚·ã‚¹ãƒ†ãƒ å…±é€šAPI
â”‚   â”œâ”€â”€ auth.routes.ts
â”‚   â”œâ”€â”€ room-grades.routes.ts
â”‚   â””â”€â”€ room-memos.routes.ts
â”œâ”€â”€ saas/           # SaaSå°‚ç”¨API
â”‚   â”œâ”€â”€ orders.routes.ts
â”‚   â””â”€â”€ device.routes.ts
â”œâ”€â”€ pms/            # PMSå°‚ç”¨API
â”‚   â”œâ”€â”€ reservation.routes.ts
â”‚   â””â”€â”€ room.routes.ts
â””â”€â”€ member/         # Memberå°‚ç”¨API
    â””â”€â”€ response-tree.routes.ts
```

---

## âœ… **æ¨å¥¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³**

### **åŸºæœ¬CRUDæ“ä½œ**
```typescript
// ãƒªã‚½ãƒ¼ã‚¹ä¸€è¦§ãƒ»ä½œæˆ
router.get('/', ...)           // GET /api/v1/rooms
router.post('/', ...)          // POST /api/v1/rooms

// å€‹åˆ¥ãƒªã‚½ãƒ¼ã‚¹æ“ä½œ
router.get('/:id', ...)        // GET /api/v1/rooms/:id
router.put('/:id', ...)        // PUT /api/v1/rooms/:id
router.delete('/:id', ...)     // DELETE /api/v1/rooms/:id
```

### **é–¢é€£ãƒªã‚½ãƒ¼ã‚¹æ“ä½œ**
```typescript
// è¦ªãƒªã‚½ãƒ¼ã‚¹ã®å­ãƒªã‚½ãƒ¼ã‚¹
router.get('/:parentId/children', ...)           // ä¸€è¦§
router.post('/:parentId/children', ...)          // ä½œæˆ
router.get('/:parentId/children/:childId', ...)  // è©³ç´°
router.put('/:parentId/children/:childId', ...)  // æ›´æ–°
router.delete('/:parentId/children/:childId', ...)// å‰Šé™¤
```

### **ç‰¹æ®Šæ“ä½œ**
```typescript
// çŠ¶æ…‹å¤‰æ›´
router.put('/:id/status', ...)        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
router.post('/:id/activate', ...)     // ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
router.post('/:id/deactivate', ...)   // éã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ

// è¨ˆç®—ãƒ»æ¤œç´¢
router.get('/search', ...)            // æ¤œç´¢
router.post('/calculate', ...)        // è¨ˆç®—
router.get('/summary', ...)           // ã‚µãƒãƒªãƒ¼
```

---

## ğŸš¨ **é¿ã‘ã‚‹ã¹ããƒ‘ã‚¿ãƒ¼ãƒ³**

### **âŒ æ·±ã„ãƒã‚¹ãƒˆ**
```typescript
// é¿ã‘ã‚‹
router.get('/hotels/:hotelId/floors/:floorId/rooms/:roomId/memos/:memoId', ...)
```

### **âŒ index ãƒ•ã‚¡ã‚¤ãƒ«**
```typescript
// é¿ã‘ã‚‹
src/routes/rooms/[roomId]/index.ts
```

### **âŒ æ›–æ˜§ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å**
```typescript
// é¿ã‘ã‚‹
router.get('/:id/items/:id', ...)  // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åé‡è¤‡

// æ¨å¥¨
router.get('/:roomId/memos/:memoId', ...)
```

### **âŒ å‹•è©ã®é‡è¤‡**
```typescript
// é¿ã‘ã‚‹
router.post('/create-room', ...)
router.get('/get-rooms', ...)

// æ¨å¥¨
router.post('/rooms', ...)
router.get('/rooms', ...)
```

---

## ğŸ“‹ **ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

æ–°ã—ã„APIãƒ«ãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼š

- [ ] å‹•çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯1éšå±¤ä»¥å†…ã‹ï¼Ÿ
- [ ] `index.*` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ã‹ï¼Ÿ
- [ ] ãƒªã‚½ãƒ¼ã‚¹åãŒæ˜ç¢ºã‹ï¼Ÿ
- [ ] ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åãŒé‡è¤‡ã—ã¦ã„ãªã„ã‹ï¼Ÿ
- [ ] ç›¸å¯¾ãƒ‘ã‚¹ã§è¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] é©åˆ‡ãªHTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ

---

## ğŸ”„ **æ—¢å­˜ãƒ«ãƒ¼ãƒˆã®ä¿®æ­£å„ªå…ˆåº¦**

### **é«˜å„ªå…ˆåº¦ï¼ˆå³åº§ã«ä¿®æ­£ï¼‰**
- ãƒ•ãƒ«ãƒ‘ã‚¹æŒ‡å®šã®çµ±ä¸€
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã®é‡è¤‡è§£æ¶ˆ

### **ä¸­å„ªå…ˆåº¦ï¼ˆæ¬¡å›ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ï¼‰**
- æ·±ã„ãƒã‚¹ãƒˆã®è§£æ¶ˆ
- å‘½åè¦å‰‡ã®çµ±ä¸€

### **ä½å„ªå…ˆåº¦ï¼ˆæ©Ÿèƒ½è¿½åŠ æ™‚ï¼‰**
- ã‚ˆã‚Šæ˜ç¢ºãªãƒªã‚½ãƒ¼ã‚¹åã¸ã®å¤‰æ›´

---

*æœ€çµ‚æ›´æ–°: 2025-01-12*
*ä½œæˆè€…: hotel-commoné–‹ç™ºãƒãƒ¼ãƒ *
