# キャンペーン機能 引き継ぎ時の既知の問題

## テスト実行時のエラー

テスト実行時に以下のようなエラーが発生しています。これらは引き継ぎ後に修正が必要です：

### 1. データベースモデル関連のエラー

```
src/integrations/campaigns/utils.ts:2:10 - error TS2305: Module '"@prisma/client"' has no exported member 'Campaign'.
```

**解決策**:
- Prismaのスキーマ定義を確認し、必要なモデルが定義されていることを確認
- `npx prisma generate`を実行して、最新のクライアントを生成

### 2. 認証ミドルウェア関連のエラー

```
src/integrations/campaigns/admin-api.ts:5:33 - error TS2307: Cannot find module '../../auth/middleware' or its corresponding type declarations.
```

**解決策**:
- 認証ミドルウェアの実装を確認
- 型定義が正しく行われていることを確認

### 3. サービスクラスのメソッド不足

```
src/integrations/campaigns/admin-api.ts:29:58 - error TS2554: Expected 0 arguments, but got 1.
```

**解決策**:
- `services.ts`の実装を確認し、テストで使用されているすべてのメソッドが実装されていることを確認
- 引数の型定義が正しいことを確認

## 動作確認時の注意点

1. **データベースマイグレーション**:
   - キャンペーン機能に必要なテーブルがすべて作成されていることを確認
   - 必要に応じて`npx prisma migrate dev`を実行

2. **環境変数**:
   - 必要な環境変数がすべて設定されていることを確認
   - 特に認証関連の設定（JWT_SECRET等）

3. **APIエンドポイントの動作確認**:
   - 各エンドポイントの動作確認を行う
   - エラーハンドリングが正しく機能することを確認

## パフォーマンス要件

- 95%のリクエストが300ms以内に応答すること
- キャッシュ機能を活用して、頻繁にアクセスされるデータのパフォーマンスを向上させること

## 今後の改善点

1. **テストカバレッジの向上**:
   - 現在のテストコードを修正し、正常に実行できるようにする
   - カバレッジを80%以上に向上させる

2. **エラーハンドリングの改善**:
   - より詳細なエラーメッセージの提供
   - エラーログの強化

3. **ドキュメントの充実**:
   - APIエンドポイントの詳細な使用例の追加
   - トラブルシューティングガイドの作成

## 連絡先

実装に関する質問やサポートが必要な場合は、hotel-common開発チームにお問い合わせください。
