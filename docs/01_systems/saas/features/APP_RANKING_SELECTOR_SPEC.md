# アプリランキングセレクタ機能仕様書

## 1. 機能概要

管理画面内でGoogle Playのカテゴリ別人気アプリランキングを表示し、ランキングから直接ホテルのアプリリストにアプリを追加できる機能を提供します。客観的なデータに基づいたアプリ選定を可能にし、常に最新の人気アプリを提供できる体制を整えます。

## 2. 技術要件

### 2.1 データソース
- **Google Play Developer API**: アプリのランキングデータ、評価、ダウンロード数などを取得
- **App Annie / Data.ai API**: より詳細なアプリ分析データを取得（有料オプション）
- **自社収集データ**: 実際のホテルでの利用統計を匿名で収集・分析（将来拡張）

### 2.2 バックエンド実装

#### API エンドポイント
- `GET /api/v1/admin/content/apps/rankings`: カテゴリ別アプリランキングを取得
- クエリパラメータ:
  - `category`: アプリカテゴリ（video, music, utility, all など）
  - `region`: 地域コード（jp, us など）
  - `page`: ページ番号（ページネーション用）
  - `limit`: 1ページあたりの表示件数

#### レスポンス形式
```json
{
  "success": true,
  "data": {
    "rankings": [
      {
        "packageName": "com.google.android.youtube",
        "displayName": "YouTube",
        "description": "動画を視聴できるアプリ",
        "iconUrl": "https://example.com/youtube.png",
        "category": "video",
        "rating": 4.5,
        "downloads": "50億+",
        "lastUpdated": "2025-07-15T00:00:00Z",
        "usageRank": 1 // ホテル内利用統計（オプション）
      },
      // 他のアプリ...
    ],
    "lastUpdated": "2025-08-03T12:34:56Z",
    "category": "video",
    "region": "jp",
    "pagination": {
      "currentPage": 1,
      "totalPages": 5,
      "totalItems": 100
    }
  }
}
```

### 2.3 フロントエンド実装

#### コンポーネント構成
- `AppRankingSelector.vue`: メインコンポーネント
- `AppRankingFilters.vue`: カテゴリ・地域フィルター
- `AppRankingList.vue`: ランキング一覧表示
- `AppRankingItem.vue`: 個別アプリ表示
- `AppAddConfirmModal.vue`: アプリ追加確認ダイアログ

#### 主要機能
- カテゴリと地域によるフィルタリング
- ページネーション
- 手動更新ボタン
- アプリ追加ボタンとフロー
- 「急上昇」バッジ表示（人気急上昇アプリ）

## 3. UI/UX設計

### 3.1 アプリ追加フロー
1. 「アプリを追加」ボタンをクリック
2. カテゴリ別ランキングタブが表示される
3. カテゴリと地域を選択してフィルタリング
4. ランキング一覧から希望のアプリを選択
5. 「追加」ボタンをクリックすると確認ダイアログ表示
6. 確認後、アプリがホテルのアプリリストに追加される

### 3.2 表示情報
- アプリ名とアイコン
- レーティング（星評価）
- ダウンロード数
- 簡潔な説明文（100文字程度に省略表示）
- カテゴリタグ
- 最終更新日
- ホテル内利用統計（オプション）

### 3.3 デザイン要件
- ホテル管理画面の既存デザインに準拠
- レスポンシブデザイン対応
- アクセシビリティ対応（色のコントラスト、キーボード操作など）
- Heroiconsアイコンを使用（プロジェクト標準）

## 4. データ更新の仕組み

### 4.1 定期更新
- バックグラウンドジョブで週次でランキングデータを更新
- 更新日時の表示（「〇日前に更新」など）
- データキャッシュによるパフォーマンス最適化

### 4.2 手動更新
- 管理者による手動更新ボタン
- 更新中の読み込み状態表示
- 更新完了通知

## 5. カテゴリ分類

### 5.1 基本カテゴリ
- 動画（video）: YouTube, Netflix, Prime Video など
- 音楽（music）: Spotify, YouTube Music など
- ユーティリティ（utility）: 天気, 地図, 翻訳 など
- ニュース（news）: 各種ニュースアプリ
- ゲーム（games）: カジュアルゲーム
- 旅行（travel）: 観光情報, 交通機関 など

### 5.2 地域設定
- 日本（jp）
- アメリカ（us）
- その他主要国（将来拡張）

## 6. セキュリティ要件

- 管理者権限を持つユーザーのみアクセス可能
- Google Play API キーの安全な管理
- レート制限の実装によるAPI乱用防止
- データキャッシュによるAPI呼び出し最小化

## 7. エラーハンドリング

- API接続エラー時の適切なフォールバック表示
- データ取得失敗時のリトライ機能
- キャッシュデータの活用による可用性確保

## 8. 実装ステップ

1. Google Play Developer APIの利用申請と設定
2. ランキングデータ取得APIの実装
3. データキャッシュと定期更新の仕組み構築
4. 管理画面UIの拡張
5. アプリ追加フローの実装
6. テストとフィードバック収集
7. 本番環境へのデプロイ

## 9. 将来の拡張性

- ホテル内利用統計との連携強化
- AIによる推奨アプリの自動提案
- 地域特化型アプリの優先表示
- ホテルタイプ（ビジネス/リゾート）に応じた推奨アプリ
- 多言語対応の強化

## 10. 成功指標

- アプリ選定時間の短縮（管理者の作業効率向上）
- 宿泊客によるアプリ利用率の向上
- アプリ選定の多様性向上（カテゴリバランス）
- 管理者からのフィードバックスコア
