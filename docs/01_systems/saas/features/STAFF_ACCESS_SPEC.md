# スタッフ用画面アクセス仕様書

## 概要
本番運用時において、客室TOP画面（`/`）からスタッフ用画面（`/tv`）へのセキュアなアクセス方法を提供します。

## アクセス方法

### 1. 隠しキー操作（PC・TV用）
客室TOP画面で以下のキー操作を順番に実行することで、スタッフ用画面にアクセスできます：

```
↑ ↑ ↓ ↓ ← → ← → Enter Escape
```

**詳細手順：**
1. 客室TOP画面（`http://IP:3100/`）を表示
2. 以下のキーを順番に押す：
   - 上矢印キー（↑）を2回
   - 下矢印キー（↓）を2回  
   - 左矢印キー（←）を1回
   - 右矢印キー（→）を1回
   - 左矢印キー（←）を1回
   - 右矢印キー（→）を1回
   - Enter（決定）キーを1回
   - Escape（戻る）キーを1回
3. 正しいシーケンスが完了すると、自動的にスタッフ用画面（`/tv`）に遷移

### 2. タッチジェスチャー（タブレット用）
タブレットでは以下のタッチジェスチャーでアクセスできます：

```
左上 → 右上 → 左下 → 右下 → 中央
```

**詳細手順：**
1. 客室TOP画面（`http://IP:3100/`）を表示
2. 画面を5つのエリアに分けて、以下の順番でタップ：
   - **左上エリア**をタップ
   - **右上エリア**をタップ
   - **左下エリア**をタップ
   - **右下エリア**をタップ
   - **中央エリア**をタップ
3. 正しいシーケンスが完了すると、自動的にスタッフ用画面（`/tv`）に遷移

### 3. 直接URL入力（開発・緊急時）
```
http://IP:3100/tv
```

## 技術仕様

### セキュリティ機能
- **タイムアウト制御**: 5秒以内に正しいシーケンスを完了する必要があります
- **シーケンスリセット**: 間違ったキーを押すか、タイムアウトするとシーケンスがリセットされます
- **ログ記録**: アクセス試行はコンソールログに記録されます

### 対応デバイス
- **TV/STB**: リモコンの方向キー + 決定ボタン
- **タブレット**: タッチジェスチャー（画面の5エリアタップ）
- **PC**: キーボード操作
- **スマートフォン**: 外付けキーボード（画面キーボードは非対応）

### 実装詳細
- **キーコード**: `ArrowUp`, `ArrowDown`, `ArrowLeft`, `ArrowRight`, `Enter`, `Escape`
- **イベント**: `keydown`イベントで検出
- **状態管理**: Vue 3 Composition APIの`ref`で管理
- **ナビゲーション**: Nuxt 3の`navigateTo`で画面遷移

## 運用上の注意点

### スタッフ向けガイドライン
1. **操作の秘匿性**: 客室でのキー操作は客前で行わない
2. **操作の確実性**: 5秒以内に正確にシーケンスを完了する
3. **終了時の対応**: 作業完了後は必ず客室TOP画面に戻る

### トラブルシューティング
- **シーケンスが効かない**: ページを再読み込みしてから再試行
- **キーボードが反応しない**: デバイスの接続を確認
- **緊急時**: 直接URL入力でアクセス

## セキュリティ考慮事項

### 脅威分析
- **偶発的発見**: 客室利用者が偶然シーケンスを発見するリスク（低）
- **意図的探索**: 悪意のあるユーザーによる探索（中）
- **情報漏洩**: スタッフからの情報漏洩（高）

### 対策
- **複雑なシーケンス**: 偶発的な発見を困難にする
- **タイムアウト**: 総当たり攻撃を困難にする
- **ログ監視**: 不正アクセス試行の検出
- **スタッフ教育**: 操作方法の適切な管理

## 今後の改善案

### 追加セキュリティ機能
1. **認証レイヤー**: スタッフ用画面でのパスワード認証
2. **時間制限**: 特定時間帯のみアクセス可能
3. **IP制限**: 特定のデバイスからのみアクセス可能
4. **ログ強化**: 詳細なアクセスログとアラート機能

### 利便性向上
1. **QRコード**: スタッフ用QRコードでの簡単アクセス
2. **NFC**: スタッフカードでのタッチアクセス
3. **音声認識**: 音声コマンドでのアクセス
4. **ジェスチャー**: タッチジェスチャーでのアクセス

---

*最終更新: 2025年1月*
*バージョン: 1.0* 