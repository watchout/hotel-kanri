# 🏨 ホテルシステム用語集

_Last updated: 2025-05-17_

---

## 1. 注文ステータス関連

### ステータス定義
| ステータスコード | 表示名（日本語） | 表示名（英語） | 説明 |
|--------------|------------|------------|------|
| `received` | 受付済み | Received | 注文が登録された初期状態 |
| `cooking` | 準備中 | In Preparation | 商品の準備作業が開始された状態 |
| `ready` | 準備完了 | Ready | 商品の準備が完了し、配達可能な状態 |
| `delivering` | 配達中 | Delivering | 客室へ配達中の状態 |
| `done` | 配達完了 | Delivered | 配達が完了した状態 |
| `cancelled` | キャンセル | Cancelled | 注文がキャンセルされた状態 |

### ステータス変更ボタン表記
| 現在のステータス | ボタン表記 | 変更後のステータス |
|--------------|------------|--------------|
| `received` | 準備開始 | `cooking` |
| `cooking` | 準備完了 | `ready` |
| `ready` | 配達開始 | `delivering` |
| `delivering` | 配達完了 | `done` |

## 2. 管理画面名称

### 管理メニュー
| 画面コード | 表示名 | 説明 |
|------------|-------|------|
| `admin/orders/manage` | 注文管理 | 全注文の一覧と管理画面 |
| `admin/orders/manage` | 準備管理 | 商品準備工程の管理画面 |
| `admin/delivery/manage` | 配達管理 | 配達工程の管理画面 |

### セクション名
| セクション | 表示名 | 説明 |
|------------|-------|------|
| `order-progress` | 配達進捗 | 注文の現在の進行状況を示すセクション |
| `order-status` | 注文状況 | 注文のステータスや履歴を表示するセクション |
| `order-items` | 注文商品 | 注文された商品一覧を表示するセクション |

## 3. 客室UI表示

### ステータスディスプレイ
| ステータス | 表示テキスト | 背景色クラス | テキスト色クラス |
|------------|------------|------------|--------------|
| `received` | 受付済み | `bg-gray-100` | `text-gray-800` |
| `cooking` | 準備中 | `bg-amber-100` | `text-amber-800` |
| `ready` | 準備完了 | `bg-green-100` | `text-green-800` |
| `delivering` | 配達中 | `bg-blue-100` | `text-blue-800` |
| `done` | 配達完了 | `bg-green-100` | `text-green-800` |
| `cancelled` | キャンセル | `bg-red-100` | `text-red-800` |

### ナビゲーション要素
| 要素 | 表示名 | リンク先 |
|------|-------|---------|
| `menu-link` | メニューに戻る | `/order` |
| `cart-link` | カート | `/order/cart` |
| `history-link` | 注文履歴 | `/order/history` |

## 4. 通知メッセージ

### ステータス変更通知
| ステータス | 通知タイトル | 通知メッセージ |
|------------|------------|-------------|
| `cooking` | 準備が開始されました | スタッフがご注文の準備を開始しました。 |
| `ready` | 準備が完了しました | まもなくお届けします。 |
| `delivering` | 配達が始まりました | まもなくお届けします。 |
| `done` | 配達が完了しました | ご注文品をお受け取りください。 |
| `cancelled` | 注文がキャンセルされました | 何らかの理由でキャンセルされました。スタッフにお問い合わせください。 |

## 5. キッチン管理UI表示

### ステータスラベル（キッチンスタッフ向け）
| ステータス | 表示テキスト | 説明 |
|------------|------------|------|
| `received` | 準備待ち（調理待ち） | キッチンスタッフにより理解しやすい表現で併記 |
| `cooking` | 準備中（調理中） | キッチンスタッフにより理解しやすい表現で併記 |
| `ready` | 準備完了（調理完了） | キッチンスタッフにより理解しやすい表現で併記 |
| `delivering` | 配達中 | 配達スタッフが客室に商品を届けている状態 |
| `done` | 配達完了 | 客室への配達が完了した状態 |
| `cancelled` | キャンセル | 注文がキャンセルされた状態 |

## 6. 注意事項

1. 今後新しい用語や表現を追加する場合は、このドキュメントに追記し、チーム全体で共有してください。
2. 複数の言語で表示する必要がある場合は、言語ごとの表現も記載してください。
3. 用語を変更する場合は、変更前の用語と変更理由も記録してください。
4. キッチン管理UIでは、スタッフの理解を助けるために括弧書きで従来の表現を併記することがあります。

---

## 変更履歴

| 日付 | 変更内容 | 変更者 |
|------|---------|-------|
| 2025-05-17 | 初版作成 | Tech Team |
| 2025-05-17 | 「配膳」→「配達」に用語統一 | Tech Team |
| 2025-05-17 | キッチン管理UI向けに併記表現を追加 | Tech Team |

## 7. 商品ごとの準備状態管理（ハイブリッド方式）

### 背景
現状のシステムではオーダー単位で状態管理を行っていますが、実際のキッチン業務では同一オーダー内の複数商品をそれぞれ個別に準備状態管理する必要があります。ホテルでは1オーダー＝1配膳となる場合が多いですが、飲食店などでは1商品＝1配膳となるケースも多いため、両方の運用パターンに対応する必要があります。

### 実装方針
1. **データモデルの拡張**
   ```prisma
   model OrderItem {
     id             Int          @id @default(autoincrement())
     orderId        Int
     order          Order        @relation(fields: [orderId], references: [id])
     menuItemId     Int
     menuItem       MenuItem     @relation(fields: [menuItemId], references: [id])
     quantity       Int
     status         String       @default("pending") // pending, cooking, ready, delivered
     deliveredAt    DateTime?    // 配達完了時刻
     notes          String?
     createdAt      DateTime     @default(now())
     updatedAt      DateTime     @updatedAt
   }
   
   model Order {
     // 既存のフィールド
     deliveryMode   String       @default("unified") // "unified"(一括) または "separate"(個別)
   }
   ```

2. **配達モード**
   | モード | 説明 | 適用例 |
   |-------|------|-------|
   | `unified` | 一括配達モード（オーダー単位） | ルームサービスなど、1回の配達で全商品を届ける運用 |
   | `separate` | 個別配達モード（商品単位） | レストランなど、商品ごとに調理完了次第配達する運用 |

3. **UI表示**
   - オーダー内の各商品ごとに準備状態を表示
   - 配達モードに応じて表示と操作方法を変更
   - 一括モード: オーダー全体のステータス操作ボタンを表示
   - 個別モード: 商品ごとのステータス操作ボタンを表示

4. **ステータス遷移**
   | アイテムステータス | 表示名 | 説明 |
   |---------------|------|------|
   | `pending` | 準備待ち（調理待ち） | 準備が開始されていない状態 |
   | `cooking` | 準備中（調理中） | 準備作業が進行中の状態 |
   | `ready` | 準備完了（調理完了） | 商品の準備が完了した状態 |
   | `delivered` | 配達済 | 商品が配達された状態 |
   | `done` | 完了 | 配達が完了した状態 |

### UI変更点
1. 各商品行にステータス表示とボタンを追加
2. 商品ごとに異なる背景色でステータスを視覚化
3. 配達モード切替のトグル追加
4. 個別モードでは全商品の状態を同期：
   - 全ての商品が同じ状態になったら、オーダー全体の状態も更新
   - オーダー全体の状態は最も進んでいない商品の状態を反映

### ステータス同期ルール
1. **一括モード（unified）**: 
   - オーダーのステータス変更時、全商品のステータスも一括で更新
   - UI上は主にオーダー全体の操作ボタンを表示

2. **個別モード（separate）**:
   - 商品ごとに個別のステータス変更が可能
   - 全商品が特定のステータスになった時、オーダー全体のステータスも自動更新
   - 最も進行が遅い商品のステータスがオーダー全体のステータスとなる

### 実装フェーズ
1. **フェーズ1**: UI上での商品ごとの状態管理と配達モード切替（データベース変更なし）
2. **フェーズ2**: OrderItemテーブル拡張と完全な個別管理
3. **フェーズ3**: 店舗設定で配達モードのデフォルト値を設定可能に