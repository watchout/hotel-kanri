# Hotel SaaS 開発ルール チェックリスト

## 📋 **定期確認フロー**

### **確認タイミング**
- [ ] 新機能開発開始時
- [ ] プルリクエスト作成前
- [ ] 週次レビュー時
- [ ] 月次振り返り時
- [ ] 重大バグ発生時

---

## 🚨 **データベース管理ルール（厳守）**

### **禁止事項チェック**
- [ ] `npx prisma migrate reset` の安易な実行をしていない
- [ ] `npx prisma db push --force-reset` を使用していない
- [ ] `rm ./prisma/dev.db` などのファイル削除をしていない
- [ ] 複数データベースファイルを作成していない
- [ ] データベースパス変更をしていない

### **推奨操作チェック**
- [ ] データ変更前にバックアップを作成している
- [ ] Prismaクライアントを使用したデータ操作をしている
- [ ] ソフトデリート（`isDeleted: true`）を実装している

---

## 💡 **既存システムへの影響回避**

### **事前確認チェック**
- [ ] オーダー機能への影響を確認済み
- [ ] `prisma/schema.prisma` 変更時に影響範囲を確認済み
- [ ] `server/api/` 既存API変更時に影響を確認済み
- [ ] `middleware/` 共通ミドルウェア変更時に影響を確認済み
- [ ] 依存関係変更時に影響を確認済み

### **実装方針チェック**
- [ ] 既存テーブル変更を避け、新テーブル追加で対応
- [ ] 既存API変更を避け、新APIエンドポイント作成
- [ ] 共通コンポーネントは新規作成を優先
- [ ] 名前空間を明確に分離（`/info`, `/api/v1/info`等）

---

## 🎯 **UI/UX 統一ルール**

### **アイコン統一チェック**
- [ ] 全てのアイコンで `heroicons:` プレフィックスを使用
- [ ] 標準アイコンを使用（trash, pencil-square, plus, x-mark等）

### **モーダル統一チェック**
- [ ] 全てのモーダルで `ConfirmModal` コンポーネントを使用
- [ ] 適切なインポート文を追加済み
- [ ] 削除系モーダルで `type: 'warning'` を使用
- [ ] 成功系モーダルで `type: 'success'` を使用
- [ ] エラー系モーダルで `type: 'error'` を使用

---

## 🚨 **エラーハンドリング統一ルール**

### **API処理チェック**
- [ ] 全てのAPI呼び出しでtry-catch使用
- [ ] エラー時に `showModal` でユーザーフィードバック
- [ ] 成功時に成功メッセージを表示
- [ ] 長時間処理でローディング状態を管理
- [ ] デバッグ用の `console.log` を適切に配置

### **エラーメッセージチェック**
- [ ] ユーザーフレンドリーなエラーメッセージ
- [ ] 具体的な解決方法を提示
- [ ] 技術的詳細を隠蔽

---

## 📊 **データ同期ルール**

### **データ更新チェック**
- [ ] データ更新後に関連データを `refresh()` で再取得
- [ ] 複数データ影響時に全関連データを更新
- [ ] `useFetch` の `refresh()` を適切に活用
- [ ] キャッシュ無効化を適切に実行

---

## 🔧 **TypeScript 型安全ルール**

### **型安全チェック**
- [ ] `any` 型の多用を避けている
- [ ] オプショナルチェーン `?.` を活用
- [ ] 配列アクセス前に存在確認
- [ ] APIレスポンスの型定義を作成
- [ ] 型エラーを放置していない

---

## ⚡ **パフォーマンス・UX ルール**

### **パフォーマンスチェック**
- [ ] 複数API呼び出しで `Promise.all` 使用
- [ ] 500ms以上の処理でローディング表示
- [ ] 楽観的更新でUIを即座に更新
- [ ] エラー時に元の状態に戻す処理

### **UXチェック**
- [ ] タブレット横型（16:9）対応
- [ ] スクロール操作を最小化
- [ ] レスポンシブデザイン実装
- [ ] アクセシビリティ考慮

---

## 🔒 **セキュリティルール**

### **セキュリティチェック**
- [ ] 全ての入力データをバリデーション
- [ ] Prisma ORM使用、生SQL最小限
- [ ] ユーザー入力を適切にエスケープ
- [ ] 管理者機能で権限チェック実装
- [ ] 外部IPアドレスのハードコード禁止

---

## 🛠 **開発環境ルール**

### **環境設定チェック**
- [ ] 開発サーバーで `0.0.0.0:3100` 使用
- [ ] 固定ポート 3100/3200/3300 を使用（`strictPort: true` 設定済み）
- [ ] Android Studio連携を考慮

---

## 📝 **定期レビューアクション**

### **週次確認（毎週金曜日）**
1. [ ] 新規作成したコンポーネントのルール準拠確認
2. [ ] エラーハンドリングの実装状況確認
3. [ ] 型安全性の確認
4. [ ] パフォーマンス問題の確認

### **月次確認（月末）**
1. [ ] データベース整合性確認
2. [ ] セキュリティ脆弱性確認
3. [ ] ルール違反の修正状況確認
4. [ ] 新しいルール追加の検討

### **緊急確認（バグ発生時）**
1. [ ] ルール違反が原因でないか確認
2. [ ] 同様の問題を防ぐルール追加検討
3. [ ] 修正内容のルール準拠確認

---

## 🎯 **ルール違反時の対応**

### **発見時のアクション**
1. **即座に修正**: 軽微な違反は即座に修正
2. **影響範囲確認**: 既存機能への影響を確認
3. **根本原因分析**: なぜ違反が発生したか分析
4. **ルール改善**: 必要に応じてルールを改善

### **予防策**
1. **チェックリスト活用**: 開発前にチェックリスト確認
2. **ペアレビュー**: 重要な変更は複数人でレビュー
3. **自動化検討**: 可能な部分は自動チェック導入
4. **教育**: チーム全体でルール共有

---

## 📊 **メトリクス追跡**

### **品質指標**
- [ ] ルール準拠率: ____%
- [ ] バグ発生率: ____件/週
- [ ] コードレビュー指摘率: ____%
- [ ] 型エラー発生率: ____%

### **改善指標**
- [ ] 開発速度: ____時間/機能
- [ ] 修正時間: ____時間/バグ
- [ ] ユーザー満足度: ____点/5点
- [ ] システム安定性: ____%

---

**最終更新**: `date +%Y-%m-%d`
**次回確認予定**: `date -d "+1 week" +%Y-%m-%d`
