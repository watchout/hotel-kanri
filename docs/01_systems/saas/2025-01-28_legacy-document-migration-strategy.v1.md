# 既存ドキュメント移行戦略の決定

**Doc-ID**: ADR-2025-002
**Version**: 1.0
**Status**: Active
**Owner**: 金子裕司
**Linked-Docs**: SPEC-2025-001, ADR-2025-001

---

## 📋 **決定事項**

hotel-saasプロジェクトの既存ドキュメント（66個のfeatures/、34個のmigration/等、総計200+ファイル）について、**段階的移行戦略**を採用し、重要度・活用度に基づく優先順位付けによる体系的な整理を実施する。

## 🎯 **背景・課題**

### **現状分析**
```
docs/
├── features/        66ファイル（機能仕様・設計書）
├── migration/       34ファイル（移行・統合関連）
├── api/            15ファイル（API仕様書）
├── auth/           10ファイル（認証関連）
├── business/       15ファイル（ビジネス仕様）
├── database/       23ファイル（DB設計・移行）
├── info/           11ファイル（インフォメーション機能）
├── order/          11ファイル（注文機能）
├── statistics/      4ファイル（統計機能）
└── その他          30+ファイル
```

### **解決すべき課題**
1. **情報の重複**: 同一トピックが複数ファイルに分散
2. **古い情報の混在**: 実装済み・廃止済み情報が残存
3. **検索困難**: 必要な情報の発見に時間がかかる
4. **保守負荷**: 更新時の関連ファイル特定が困難

## 🏗️ **移行戦略決定**

### **1. 3段階移行アプローチ**

#### **Phase 1: 重要度A（1週間）**
**対象**: 現在も参照される重要ドキュメント
- 認証システム設計書
- API統合仕様書
- データベース設計書
- アーキテクチャ設計書

**アクション**: 新形式への完全移行

#### **Phase 2: 重要度B（2週間）**
**対象**: 機能別の詳細仕様書
- 各機能の技術仕様書
- 実装ガイド
- 移行計画書

**アクション**: 統合・簡素化して移行

#### **Phase 3: 重要度C（1ヶ月）**
**対象**: 履歴・参考資料
- 古い設計案
- 廃止された機能の仕様
- 実験的な検討資料

**アクション**: アーカイブまたは削除

### **2. ディレクトリ構造戦略**

#### **新構造への分類**
```
docs/
├── specs/           ← features/, api/, database/ の重要分を統合
├── adr/            ← 技術判断記録（新規）
├── minutes/        ← 議論記録（新規）
├── release/        ← 実装成果記録（新規）
├── summary/        ← 進捗サマリ（新規）
└── legacy/         ← 既存ドキュメント保持
    ├── features/   ← 既存のまま保持
    ├── migration/  ← 既存のまま保持
    └── archived/   ← 不要ファイルの最終保管場所
```

#### **legacy/ディレクトリの役割**
- **既存ドキュメントの完全保持**: 参照可能性を維持
- **段階的移行の基盤**: 移行作業の安全な実施
- **履歴保持**: 過去の判断根拠の保持

### **3. 移行判定基準**

#### **重要度A（優先移行）**
- [ ] 現在も定期的に参照される
- [ ] 実装・運用に直接影響する
- [ ] 他ドキュメントから多数参照される
- [ ] 最新情報が反映されている

#### **重要度B（統合移行）**
- [ ] 特定機能に関する詳細情報
- [ ] 部分的に古い情報を含む
- [ ] 他の情報と統合可能
- [ ] 将来的に参照の可能性がある

#### **重要度C（アーカイブ）**
- [ ] 1年以上更新されていない
- [ ] 実装済み・廃止済みの機能
- [ ] 実験的・検討段階の資料
- [ ] 重複情報

## 🔄 **具体的移行計画**

### **Phase 1: 重要度A移行（1週間）**

#### **対象ファイル（例）**
```yaml
認証関連:
  - docs/auth/JWT_AUTH_DESIGN.md → specs/2025-01-28_jwt-authentication-design.v1.md
  - docs/auth/unified-auth-system-design.md → 上記に統合

API関連:
  - docs/api/UNIFIED_API_SPECIFICATION.md → specs/2025-01-28_unified-api-specification.v1.md
  - docs/API_SPEC.md → 上記に統合

アーキテクチャ関連:
  - docs/ARCHITECTURE.md → specs/2025-01-28_system-architecture.v1.md
  - docs/architecture/DB_ACCESS_POLICY.md → adr/2025-01-28_database-access-policy.v1.md
```

#### **移行作業手順**
1. **内容統合**: 関連ファイルの情報を統合
2. **新形式適用**: Doc-ID、Linked-Docs等を付与
3. **品質確認**: 情報の正確性・完全性を確認
4. **リンク更新**: 他ドキュメントからの参照を更新

### **Phase 2: 重要度B移行（2週間）**

#### **統合方針**
- **機能別統合**: 同一機能の複数ファイルを1つに統合
- **重複排除**: 同じ情報の重複を排除
- **最新化**: 古い情報を最新情報に更新

#### **対象例**
```yaml
注文機能:
  - docs/order/ 11ファイル → specs/2025-01-XX_order-system-specification.v1.md

インフォメーション機能:
  - docs/info/ 11ファイル → specs/2025-01-XX_information-system-specification.v1.md

統計機能:
  - docs/statistics/ 4ファイル → specs/2025-01-XX_statistics-system-specification.v1.md
```

### **Phase 3: 重要度C処理（1ヶ月）**

#### **アーカイブ基準**
- 実装完了済みの機能仕様
- 廃止された設計案
- 実験的な検討資料
- 重複する古い情報

#### **処理方法**
```bash
# アーカイブディレクトリに移動
mv docs/features/obsolete-feature.md docs/legacy/archived/

# 削除対象（完全に不要な場合）
rm docs/features/duplicate-spec.md
```

## 📊 **移行管理システム**

### **移行状況トラッキング**
```yaml
移行管理表:
  - 元ファイルパス
  - 移行先Doc-ID
  - 移行ステータス (未着手/進行中/完了/アーカイブ)
  - 移行担当者
  - 移行完了日
  - 備考
```

### **品質チェックリスト**
- [ ] Doc-ID付与済み
- [ ] Linked-Docs整備済み
- [ ] 情報の正確性確認済み
- [ ] 重複情報の排除済み
- [ ] 参照リンクの更新済み

## ⚖️ **代替案との比較**

### **検討した代替案**

#### **案A: 一括移行**
- **メリット**: 短期間で完了
- **デメリット**: 品質リスク、作業負荷集中
- **判定**: ❌ リスクが高すぎる

#### **案B: 既存構造維持**
- **メリット**: 変更コストなし
- **デメリット**: 現状の問題が継続
- **判定**: ❌ 長期的な効率性に問題

#### **案C: 段階的移行（採用）**
- **メリット**: リスク管理、品質確保、段階的改善
- **デメリット**: 移行期間が長い
- **判定**: ✅ バランスの取れたアプローチ

## 🚨 **リスク・対策**

### **移行リスク**
- **リスク**: 重要情報の見落とし
- **対策**: 移行前の詳細レビュー、チェックリスト活用

### **参照リスク**
- **リスク**: 既存リンクの切れ
- **対策**: legacy/ディレクトリでの既存ファイル保持

### **品質リスク**
- **リスク**: 情報の劣化・不正確化
- **対策**: 移行時の内容検証、専門知識者によるレビュー

## 📈 **成功指標**

### **短期指標（1ヶ月）**
- [ ] 重要度Aドキュメント100%移行完了
- [ ] 新形式ドキュメント品質スコア95%以上
- [ ] 既存リンク切れ0件

### **中期指標（3ヶ月）**
- [ ] 全移行対象ドキュメント処理完了
- [ ] ドキュメント検索時間50%短縮
- [ ] 重複情報90%削減

### **長期指標（6ヶ月）**
- [ ] legacy/ディレクトリ参照率10%以下
- [ ] 新規ドキュメント作成効率200%向上
- [ ] ドキュメント保守コスト70%削減

## 🎊 **結論**

hotel-saasプロジェクトの既存ドキュメントについて、**段階的移行戦略**を採用する。重要度に基づく優先順位付けにより、リスクを最小化しながら体系的な整理を実現する。

legacy/ディレクトリでの既存ファイル保持により、移行期間中の参照可能性を維持し、安全で確実な移行を実施する。
