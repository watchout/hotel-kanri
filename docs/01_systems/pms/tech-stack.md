# 📦 OmotenasuAI PMS "Tsukuyomi" 技術スタック定義書

このドキュメントは、ホテル向けAI統合型会計システム「OmotenasuAI PMS 'Tsukuyomi'」の開発における技術スタックの選定方針を記録したものです。

---

## 🧱 フロントエンド

| 項目 | 採用技術 | 理由・備考 |
|------|----------|-------------|
| フレームワーク | Vue 3 (Composition API) | 軽量・拡張性・学習コストが低く、個人開発に最適 |
| UIライブラリ | Tailwind CSS | 柔軟なスタイル設計・ダークモード対応・高速開発向き |
| 状態管理 | Pinia | Vue公式・型安全・モジュール分離が容易 |
| バンドラ | Vite | 高速ビルド・ホットリロード性能に優れる |

---

## 💻 デスクトップアプリ基盤

| 項目 | 採用技術 | 理由・備考 |
|------|----------|-------------|
| 実行環境 | Electron | オフライン動作・ネイティブアプリ対応 |
| UIレンダリング | Webベース (Vue) | Electronの内部ブラウザで表示 |
| 配布方法 | Electron パッケージング | 将来的なauto-updater対応も視野 |

---

## 🗄 データベース・同期

| 項目 | 採用技術 | 理由・備考 |
|------|----------|-------------|
| ローカルDB | SQLite | 軽量・Electronとの相性良し・高速アクセス |
| ORM候補 | Drizzle ORM（第一候補） | 型安全・SQLite対応・軽量で扱いやすい |
| 同期方式 | JSONベースの差分同期 | `uuid` + `updated_at` による変更検知と競合回避 |

---

## 🧪 テスト・品質保証

| 項目 | 採用技術 | 理由・備考 |
|------|----------|-------------|
| 単体テスト | Vitest | Vite + Vueと親和性が高く、軽量・高速 |
| E2Eテスト | Playwright / Cypress | Electronアプリでも安定動作・画面遷移確認可能 |

---

## 🔐 その他予定

| 項目 | 技術・方針 | 備考 |
|------|------------|-------|
| 認証 | ローカル認証（PIN/スタッフID） | オフライン前提の認証手段 |
| ネットワーク復旧時同期 | 自動同期（失敗時手動リトライ） | リトライロジックを組み込み予定 |

---

## 🔗 システム間連携技術

| 項目 | 採用技術 | 理由・備考 |
|------|----------|-------------|
| 共通ライブラリ | hotel-common（Node.js/TypeScript） | システム間の共通機能・API定義・型安全性確保 |
| API通信 | REST API（Axios/Fetch） | hotel-saas, hotel-memberとの連携用 |
| 認証連携 | JWT + 共通認証基盤 | システム間の統一認証・シングルサインオン |
| データ交換 | JSON形式 + スキーマ検証 | hotel-commonで定義された共通データ形式 |

---

## 🗃 データベース連携戦略

| 項目 | 方針 | 詳細 |
|------|------|------|
| ローカルDB | SQLite（独立運用） | オフライン優先・PMS専用データ |
| 連携データ | 定期同期方式 | hotel-member（会員情報）、hotel-saas（ゲスト履歴）との連携 |
| 共通スキーマ | hotel-common準拠 | システム間でのデータ整合性確保 |
| 同期頻度 | 業務タイミング連動 | チェックイン時・チェックアウト時など |

---

## 🚧 今後検討事項（Phase 2以降）
- 自動アップデート機能（Electron AutoUpdater）
- リアルタイム同期（WebSocket/SSE）
- 多拠点同期対応（ホテルチェーングループ）
- hotel-integrationとの統合テスト環境

--- 